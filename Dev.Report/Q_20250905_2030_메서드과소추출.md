# Q_20250905_2030_메서드과소추출.md

## 질문 개요

Java 파일 인식이 성공했음에도 불구하고 **메서드 추출이 44.2% 부족한 문제**가 발생하고 있습니다.

## 전후 배경

### 개선 작업 결과
- **Java 파일 인식**: ✅ 16개 모두 성공 (이전 0개 → 16개)
- **클래스 인식**: ✅ 19개 추출 (명세서 16개 대비 18.8% 과대)
- **메서드 인식**: ❌ 43개 추출 (명세서 77개 대비 44.2% 과소)

### 명세서 기준 메서드 분포
```
- UserController.java: 3개 메서드
- ProductController.java: 3개 메서드  
- ErrorController.java: 4개 메서드
- SyntaxErrorController.java: 5개 메서드
- MixedErrorController.java: 5개 메서드
- UserService.java: 6개 메서드 (인터페이스)
- UserServiceImpl.java: 6개 메서드 (구현체)
- ProductService.java: 4개 메서드 (인터페이스)
- ProductServiceImpl.java: 4개 메서드 (구현체)
- LogicErrorService.java: 6개 메서드
- MixedErrorService.java: 6개 메서드
- UserMapper.java: 7개 메서드 (MyBatis)
- ProductMapper.java: 5개 메서드 (MyBatis)
- BrokenMapper.java: 9개 메서드 (MyBatis)
- User.java: 11개 필드 (getter/setter 포함)
- Product.java: 8개 필드 (getter/setter 포함)
총 예상: 77개 메서드
```

## 문제점 상세 분석

### 1. 구체적 사례 분석
**사례 파일**: `UserController.java`

**기대값**: 3개 메서드
**실제값**: 확인 필요

**예상 메서드**:
```java
@RestController
public class UserController {
    public List<User> getUsers() { ... }        // 메서드 1
    public User getUserById(Long id) { ... }    // 메서드 2  
    public User createUser(User user) { ... }   // 메서드 3
}
```

**의심 원인**:
1. **정규식 패턴 문제**: 메서드 시그니처 인식 패턴이 부정확
2. **어노테이션 처리**: `@RequestMapping`, `@GetMapping` 등 Spring 어노테이션이 있는 메서드 누락
3. **제네릭 타입**: `List<User>` 같은 제네릭 반환 타입 처리 실패
4. **접근 제한자**: `public`, `private`, `protected` 조합 처리 문제

### 2. 인터페이스 vs 구현체 처리
**사례**: `UserService.java` (인터페이스) vs `UserServiceImpl.java` (구현체)

**문제 추정**:
- 인터페이스의 추상 메서드 인식 실패
- 구현체의 `@Override` 메서드 중복/누락 처리
- 인터페이스와 구현체 메서드 매핑 문제

### 3. MyBatis 매퍼 인터페이스 처리  
**사례**: `UserMapper.java`, `ProductMapper.java`

**특징**:
- 모든 메서드가 추상 메서드 (구현부 없음)
- `@Select`, `@Insert`, `@Update`, `@Delete` 어노테이션 포함
- XML 매퍼와 연결되는 메서드들

**의심 원인**:
- 추상 메서드 인식 로직 부재
- MyBatis 어노테이션 처리 실패

### 4. 모델 클래스 getter/setter 처리
**사례**: `User.java` (11개 필드), `Product.java` (8개 필드)

**예상 메서드**:
- 각 필드당 getter/setter 2개씩
- 생성자, toString, equals, hashCode 등 추가 메서드

**의심 원인**:
- Lombok 어노테이션 처리 (자동 생성된 메서드 인식 불가)
- getter/setter 패턴 인식 실패
- 생성자 오버로딩 처리 문제

## 핵심 질문

다음 사항들에 대한 해결 방안을 제시해 주세요:

### 1. 메서드 추출 로직 진단
**질문**: 현재 JavaParser의 메서드 추출 로직에서 어떤 부분이 문제인가요?
- `_extract_methods_aggressive()` 메서드의 정규식 패턴 검증
- Spring Framework 어노테이션 처리 방법
- 제네릭 타입과 복잡한 시그니처 처리 개선 방안

### 2. 인터페이스와 추상 메서드 처리
**질문**: 인터페이스의 추상 메서드를 정확히 인식하려면 어떻게 개선해야 하나요?
- 메서드 구현부가 없는 추상 메서드 인식 방법
- 인터페이스와 구현체 간 메서드 매핑 방법
- `@Override` 어노테이션 처리 로직

### 3. 어노테이션 기반 메서드 처리
**질문**: Spring과 MyBatis 어노테이션이 포함된 메서드를 어떻게 처리해야 하나요?
- `@RequestMapping`, `@GetMapping` 등 Spring 어노테이션 인식
- `@Select`, `@Insert` 등 MyBatis 어노테이션 처리
- 어노테이션과 메서드 시그니처 통합 파싱 방법

### 4. 모델 클래스 특수 처리
**질문**: getter/setter와 자동 생성 메서드를 어떻게 인식할 수 있나요?
- Lombok 어노테이션(`@Data`, `@Getter`, `@Setter`) 처리 방법
- 표준 getter/setter 패턴 인식 개선
- 생성자, toString, equals, hashCode 메서드 추출

### 5. 파싱 정확도 향상 방안
**질문**: 메서드 추출 정확도를 77개로 맞추려면 어떤 순서로 개선해야 하나요?
- 가장 많이 누락되는 메서드 타입 식별
- 정규식 패턴 vs AST 파싱 방식 비교
- 점진적 개선 로드맵

## 예상 효과

### 수정 후 기대 결과
- **METHODS**: 43개 → 77개 (79% 추가 추출)
- **명세서 일치율**: 55.8% → 100%
- **파서 신뢰도**: 전체적인 파싱 품질 향상

### 부가 효과
- 코드 분석 정확도 향상으로 더 정밀한 의존성 그래프 생성
- 메서드 수준의 상세한 코드 메트릭 측정 가능
- 향후 시퀀스 다이어그램 생성 시 더 완전한 호출 관계 분석

---

**생성일시**: 2025-09-05 20:30:00  
**분석자**: SourceAnalyzer Technical Team  
**심각도**: High (핵심 기능 정확도 관련)  
**예상 수정 시간**: 3-4시간


