# Source Analyzer Visualization Implementation Plan Review (v0.0.1)

## 1. 전체 평가

`Visualize_001_Implementation_Plan.md` 문서는 시각화 기능 구현을 위한 매우 상세하고 체계적인 계획입니다. 목표, 범위, 로드맵, 데이터 격차 해소 방안, 기술 스택, CLI 설계, 템플릿 및 빌더 알고리즘까지 포괄적으로 다루고 있어, 구현자가 바로 개발에 착수할 수 있을 정도로 완성도가 높습니다. 특히 Phase 1에서 생성된 메타데이터의 한계를 명확히 인식하고 `edge_hints` 테이블을 통한 보강 방안을 제시한 점, SQL 조인 키 도출 정확도를 높이는 방안, 그리고 Cytoscape.js를 활용한 인터랙티브 뷰어 계획은 매우 긍정적입니다.

전반적으로 프로젝트의 `README.md` 및 `prd_final.md`에 명시된 "CONFIDENCE 추적", "재현율 우선", "정확하고 풍부한 메타정보"라는 핵심 목표와 잘 부합하며, 단계별 로드맵을 통해 점진적인 개발이 가능하도록 설계되었습니다.

## 2. 계획의 강점

*   **명확한 목표와 범위**: TODO1 범위가 명확하게 정의되어 있으며, 시각화 유형(의존성, 시퀀스, 컴포넌트, ERD) 및 뷰어 요구사항이 구체적입니다.
*   **체계적인 로드맵**: 개발 순서 로드맵과 구현 단계 마일스톤이 잘 정의되어 있어, 복잡한 시각화 기능을 단계적으로 구현할 수 있는 기반을 제공합니다.
*   **데이터 격차 해소 방안**: Java 메서드 호출 및 JSP/MyBatis include 엣지 해소를 위해 `edge_hints` 보조 테이블을 도입하고, 이를 빌드 단계에서 해소하는 전략은 파서의 복잡도를 줄이면서도 정확도를 높일 수 있는 효과적인 접근 방식입니다.
*   **SQL 조인 키 도출 개선**: Alias 해소, 스키마 정규화, PK 교차검증, 복합키 추론 및 Confidence 보정 등 SQL 조인 정보의 정확도를 높이기 위한 상세한 방안이 제시되어 ERD 및 의존성 그래프의 품질을 크게 향상시킬 것입니다.
*   **Cytoscape.js 활용**: 인터랙티브 그래프 시각화 라이브러리로 Cytoscape.js를 선택하고, 기본적인 줌/팬/드래그, 검색, PNG export 기능을 포함한 템플릿 구조를 제시한 점은 실용적입니다.
*   **CLI 설계**: `argparse` 기반의 서브커맨드(graph, erd, component, sequence) 구조는 사용자 친화적이며 확장성이 좋습니다.
*   **Confidence 활용**: `Join.confidence`를 ERD 엣지의 색상/굵기 차등 표현에 활용하는 등 Confidence 점수를 시각화에 적극적으로 반영하는 계획은 매우 훌륭합니다.

## 3. 개선/고려 사항

### 3.1. Java 메서드 오버로드 해소 정확도 강화 (우선순위 높음)

*   **현황**: 현재 `_choose_overload` 함수는 메서드 시그니처의 `arg_count`만을 기준으로 오버로드를 해소합니다. 계획의 11.1절("오버로드(Overload) 해소")에서는 파라미터 타입 문자열 매칭을 통한 정확도 개선 방안을 제시하고 있으나, 이는 "추후 항목"으로 분류되어 있습니다.
*   **개선 제안**: Java에서 오버로딩은 `arg_count`뿐만 아니라 `parameter types`에 따라 결정되므로, 시각화의 정확성을 위해 `arg_count`와 `parameter types`를 모두 고려하는 오버로드 해소 로직을 TODO1 범위 내에서 우선적으로 구현하는 것을 권장합니다. 이는 메서드 호출 그래프의 품질에 직접적인 영향을 미칩니다.

### 3.2. MyBatis `<include refid>` 엣지 명시적 표현 (우선순위 중간)

*   **현황**: 계획의 2.1.3절에서 MyBatis `<include refid>`는 XML 파서가 이미 SQL을 치환한다고 언급하며, "문서 그래프 측면에서 “정의→사용”을 별도 엣지로 표현하려면 유사한 `edge_hints`를 추가하고, 매퍼 내 `<sql id>` 정의로 해소하는 규칙을 추가합니다"라고 제안하고 있습니다.
*   **개선 제안**: SQL 치환은 런타임 동작이지만, 소스 코드의 논리적 의존성 관점에서 `<sql id>` 정의와 `<include refid>` 사용 간의 관계를 명시적인 엣지로 표현하는 것은 전체 의존성 그래프의 완성도를 높이는 데 중요합니다. 이를 TODO1 로드맵에 명확히 포함하여 구현하는 것을 권장합니다.

### 3.3. 시각화 빌더의 에러 처리 강화 (우선순위 중간)

*   **현황**: `visualize/builders` 내의 스니펫들은 핵심 로직에 집중되어 있으며, `project_id`가 유효하지 않거나 데이터베이스 조회 결과가 없는 경우 등 예외 상황에 대한 명시적인 에러 처리 로직이 부족합니다.
*   **개선 제안**: 각 빌더 함수 내에서 데이터 조회 실패, 유효하지 않은 입력 등에 대한 예외 처리를 추가하여, 사용자에게 더 명확한 피드백을 제공하고 시스템의 안정성을 높여야 합니다. 예를 들어, `project_id`가 존재하지 않으면 적절한 에러 메시지를 반환하거나 로그를 남기는 방식입니다.

### 3.4. 대규모 그래프 성능 최적화 추가 고려 (우선순위 중간)

*   **현황**: `max_nodes` cap 및 BFS 기반 깊이 제한은 대규모 그래프 처리에 필수적입니다. 그러나 `db.fetch_edges`와 같이 초기 단계에서 모든 엣지를 가져오는 방식은 프로젝트 규모가 매우 클 경우 메모리 및 시간 측면에서 병목이 될 수 있습니다.
*   **개선 제안**: `focus` 노드가 지정된 경우, `db.fetch_edges` 호출 시점에 이미 관련 엣지만을 필터링하여 가져오도록 쿼리를 최적화하거나, 대규모 엣지 데이터에 대한 스트리밍/페이지네이션 기법을 고려해볼 수 있습니다.

### 3.5. CLI `focus` 인자 사용성 개선 (우선순위 낮음)

*   **현황**: `graph` 서브커맨드의 `--focus` 인자는 "start node (name/path/table)"를 요구합니다. 사용자가 정확한 노드 ID나 레이블을 알기 어려울 수 있습니다.
*   **개선 제안**: 사용자가 유효한 `focus` 노드를 쉽게 찾을 수 있도록 `--list-nodes` 또는 `--find-node`와 같은 보조 CLI 커맨드를 추가하여, 특정 패턴에 맞는 노드 목록을 출력하는 기능을 제공하면 사용성이 향상될 것입니다.

### 3.6. `visualize` 모듈의 설정 로딩 메커니즘 명확화 (우선순위 낮음)

*   **현황**: `build_dependency_graph_json` 스니펫에서 `_load_config()` 함수를 호출하지만, 이 함수의 정의나 설정 파일(`config/config.yaml`)을 로드하는 구체적인 메커니즘이 계획에 명시되어 있지 않습니다.
*   **개선 제안**: `visualize` 모듈 내에서 `config/config.yaml`을 읽어오는 표준화된 방법을 `visualize/data_access.py` 또는 별도의 `visualize/config_loader.py` 파일에 명시하고, `VizDB` 초기화 시 해당 설정을 주입하도록 하는 것이 좋습니다.

## 4. 다음 단계

제시된 계획은 매우 견고하므로, 위 개선/고려 사항들을 참고하여 계획대로 구현을 진행하는 것을 권장합니다. 특히 **Java 메서드 오버로드 해소 정확도 강화**와 **MyBatis `<include refid>` 엣지 명시적 표현**은 시각화 결과의 품질에 직접적인 영향을 미치므로, TODO1 범위 내에서 우선적으로 검토 및 반영하는 것이 좋겠습니다.

이후 `visualize` 폴더 스캐폴딩 생성 및 CLI `graph`/`erd` 동작 확인부터 시작하여, 단계별로 구현을 진행하면 되겠습니다.
