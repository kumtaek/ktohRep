# A02: Cryptographic Failures (암호화 실패)

## 개요
전송/저장 데이터 보호 미흡, 취약한 알고리즘/프로토콜 사용, 키/인증서 관리 부실 등으로 민감정보가 노출되는 취약점입니다.

## 대표 징후
- 평문 HTTP, 평문 저장(PHI/PII/비밀번호)
- 취약한 알고리즘(MD5/SHA-1), 자체구현 암호화
- 인증서 검증 미흡, 고정/하드코딩 키

## 대응 방안
- HTTPS/TLS 강제, 안전한 암호 스위트와 최신 프로토콜
- 저장 데이터는 강력한 암호화(AES-GCM 등) 및 키관리(KMS/HSM)
- 비밀번호는 강력한 해시(BCrypt/Argon2, 솔트)
- 인증서/키 순환, 만료/폐기 정책, 시크릿은 환경변수/전용 보관소 사용

## 취약/안전 코드 예시
### 비밀번호 저장 (나쁜 예)
```java
String hashed = DigestUtils.md5Hex(password); // MD5 금지
```

### 비밀번호 저장 (좋은 예)
```java
BCryptPasswordEncoder encoder = new BCryptPasswordEncoder(12);
String hashed = encoder.encode(password);
```

### 대칭키 암호화 (Java AES-GCM)
```java
Cipher cipher = Cipher.getInstance("AES/GCM/NoPadding");
SecretKey key = ... // 안전한 KMS/환경변수/키파일에서 로드
byte[] iv = SecureRandom.getSeed(12);
GCMParameterSpec spec = new GCMParameterSpec(128, iv);
cipher.init(Cipher.ENCRYPT_MODE, key, spec);
byte[] ct = cipher.doFinal(plain);
```
