# 오프라인 환경 배포 가이드

## 📋 개요
SourceAnalyzer의 ERD 생성기들이 오프라인 환경에서 동작하도록 하는 가이드입니다.

## 🔧 필요한 라이브러리

### 1. Mermaid 라이브러리
- **다운로드 URL**: https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js
- **저장 위치**: `./libs/mermaid.min.js`
- **용도**: Mermaid ERD 생성기에서 사용

### 2. Cytoscape 라이브러리
- **다운로드 URL**: https://cdnjs.cloudflare.com/ajax/libs/cytoscape/3.28.1/cytoscape.min.js
- **저장 위치**: `./libs/cytoscape.min.js`
- **용도**: Cytoscape ERD 생성기에서 사용

## 📁 디렉토리 구조
```
phase1/
├── libs/
│   ├── mermaid.min.js
│   └── cytoscape.min.js
├── metadb_mermaid_erd_generator.py
├── metadb_cytoscape_erd_generator.py
└── 오프라인_환경_가이드.md
```

## 🚀 배포 단계

### 1단계: 라이브러리 다운로드
```bash
# libs 디렉토리 생성
mkdir -p libs

# Mermaid 라이브러리 다운로드
curl -o libs/mermaid.min.js https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js

# Cytoscape 라이브러리 다운로드
curl -o libs/cytoscape.min.js https://cdnjs.cloudflare.com/ajax/libs/cytoscape/3.28.1/cytoscape.min.js
```

### 2단계: 파일 검증
```bash
# 파일 크기 확인
ls -la libs/

# 예상 결과:
# mermaid.min.js    (약 2MB)
# cytoscape.min.js  (약 1.5MB)
```

### 3단계: 오프라인 테스트
```bash
# ERD 생성기 실행
python metadb_mermaid_erd_generator.py --project-name sampleSrc
python metadb_cytoscape_erd_generator.py --project-name sampleSrc

# 생성된 HTML 파일을 브라우저에서 열어서 오프라인 동작 확인
```

## 🔍 오프라인 모드 동작 방식

### 자동 감지
- **온라인 모드**: `navigator.onLine === true` 또는 HTTP/HTTPS 프로토콜
- **오프라인 모드**: `navigator.onLine === false` 또는 `file://` 프로토콜

### 라이브러리 로딩
1. **온라인 모드**: CDN에서 라이브러리 로드
2. **오프라인 모드**: 로컬 `./libs/` 디렉토리에서 라이브러리 로드
3. **오류 처리**: 로컬 파일이 없으면 콘솔에 다운로드 가이드 출력

## ⚠️ 주의사항

### 1. 파일 경로
- 라이브러리 파일은 반드시 `./libs/` 디렉토리에 저장
- 상대 경로로 참조되므로 HTML 파일과 같은 레벨에 위치해야 함

### 2. 버전 호환성
- Mermaid: 10.6.1 버전 사용
- Cytoscape: 3.28.1 버전 사용
- 다른 버전 사용 시 호환성 문제 발생 가능

### 3. 라이선스
- Mermaid: MIT 라이선스 (기업 내 무료 사용 가능)
- Cytoscape: MIT 라이선스 (기업 내 무료 사용 가능)

## 🛠️ 문제 해결

### 라이브러리 로드 실패
```javascript
// 콘솔에서 확인할 수 있는 오류 메시지
"오프라인 모드: mermaid.min.js 파일을 찾을 수 없습니다."
"오프라인 모드: cytoscape.min.js 파일을 찾을 수 없습니다."
```

### 해결 방법
1. `libs/` 디렉토리 존재 여부 확인
2. 라이브러리 파일 다운로드 상태 확인
3. 파일 권한 확인 (읽기 권한 필요)

## 📝 배포 체크리스트

- [ ] `libs/` 디렉토리 생성
- [ ] `mermaid.min.js` 다운로드 및 저장
- [ ] `cytoscape.min.js` 다운로드 및 저장
- [ ] 파일 크기 및 권한 확인
- [ ] 오프라인 모드에서 ERD 생성기 테스트
- [ ] 브라우저에서 HTML 파일 오프라인 동작 확인

## 🔄 업데이트 방법

라이브러리 업데이트가 필요한 경우:
1. 새 버전 다운로드
2. 기존 파일 교체
3. 오프라인 모드에서 테스트
4. 호환성 확인

---

**생성일**: 2025-09-04  
**버전**: 1.0  
**작성자**: SourceAnalyzer 개발팀
