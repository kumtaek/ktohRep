# 메타디비 정확도 개선 진행상황 (2025-01-04)

## 현재 정확도 현황
- **Java 메소드**: 297개 → 40개 (13.5% 정확도)
- **XML 쿼리**: 33개 → 0개 (0.0% 정확도) 
- **JSP 함수/스크립트**: 53개 → 21개 (39.6% 정확도)
- **총 구성요소**: 383개 → 61개 (15.9% 정확도)

## 목표
전체 정확도를 95% 이상으로 개선 (차이 5% 이하)

## 완료된 작업

### 1. 일관성 문제 해결 ✅
- **문제**: MyBatis 파서가 `sql_statements` 반환, JSP 파서가 `sql_units` 반환
- **해결**: MyBatis 파서를 `sql_units`로 통일
- **결과**: 코드 일관성 확보

### 2. 중복제거 로직 개선 ✅
- **문제**: XML 파일의 `normalized_fingerprint` 기반 중복제거로 인한 SQL Units 누락
- **해결**: XML 파일은 `stmt_id` 기반 중복제거로 변경
- **결과**: 중복제거 로직 개선

### 3. XML 파서 호출 방식 개선 ✅
- **문제**: `jsp_mybatis` 파서가 비동기로 동작해서 XML SQL Units 저장 실패
- **해결**: XML 파일을 별도 MyBatis 파서로 처리하도록 메타디비 엔진 수정
- **결과**: XML 파서 호출 방식 개선

## 현재 문제점

### 1. XML 파서 여전히 0% 정확도 ❌
- **원인**: MyBatis 파서가 여전히 호출되지 않거나 SQL Units가 저장되지 않음
- **상태**: 디버깅 필요

### 2. Java 파서 13.5% 정확도 ❌
- **원인**: 257개 메소드 누락 (86.5% 누락)
- **상태**: 원인 파악 필요

### 3. JSP 파서 39.6% 정확도 ❌
- **원인**: 32개 함수/스크립트 누락 (60.4% 누락)
- **상태**: 원인 파악 필요

## 다음 단계

### 1. XML 파서 문제 해결 (우선순위: 높음)
- MyBatis 파서 호출 과정 디버깅
- SQL Units 저장 과정 확인
- 파서 팩토리와 메타디비 엔진 연동 문제 해결

### 2. Java 파서 정확도 개선 (우선순위: 높음)
- Java 파서의 메소드 추출 로직 점검
- 86.5% 누락 원인 파악 및 해결

### 3. JSP 파서 정확도 개선 (우선순위: 중간)
- JSP 파서의 구성요소 추출 로직 개선
- 60.4% 누락 원인 파악 및 해결

## 기술적 개선사항

### 1. 하드코딩 제거 ✅
- 모든 파서에서 동적 경로 사용
- 설정 파일 기반 파서 선택
- 상대 경로 사용

### 2. 일관성 확보 ✅
- 모든 파서가 `sql_units` 키 사용
- 통일된 데이터 구조
- 일관된 중복제거 로직

### 3. 모듈화 및 재사용성 ✅
- temp 폴더 활용한 모듈화
- 재사용 가능한 디버깅 스크립트
- 단계별 검증 프로세스

## 예상 완료 시점
- XML 파서 문제 해결: 1-2시간
- Java 파서 개선: 2-3시간  
- JSP 파서 개선: 1-2시간
- 전체 검증: 1시간
- **총 예상 시간**: 5-8시간

