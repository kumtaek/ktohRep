# Calls 관계 정확도 개선 보고서

## 개요
Java 파서의 calls 관계 분석 정확도를 향상시키기 위해 4가지 핵심 개선안을 적용했습니다.

## 적용된 개선사항

### 1단계: Java 키워드 필터링 강화
**목표**: if, for, while 등 Java 예약어를 메서드 호출로 잘못 인식하는 문제 해결

**적용 내용**:
- Java 예약어 목록 확장 (기존 25개 → 35개)
- 추가된 키워드: `default`, `instanceof`, `assert`, `boolean`, `byte`, `char`, `short`, `int`, `long`, `float`, `double`, `void`, `enum`, `const`, `goto`
- 필터링 함수 `_is_java_keyword()` 추가로 재사용성 향상

**효과**: Java 키워드로 인한 잘못된 calls 관계 생성 방지

### 2단계: 메서드 호출 패턴 정교화
**목표**: object.method() 형태의 명확한 호출 패턴만 calls 관계로 인식

**적용 내용**:
- 기존 광범위한 정규식 `r'(\w+)\s*\('` 제거
- 구체적인 패턴으로 교체:
  - `r'[a-zA-Z0-9_]+\.([a-zA-Z0-9_]+)\s*\('` - 일반 객체.메서드() 호출
  - `r'this\.([a-zA-Z0-9_]+)\s*\('` - this.메서드() 호출
  - `r'super\.([a-zA-Z0-9_]+)\s*\('` - super.메서드() 호출

**효과**: 생성자 호출, 타입 캐스팅 등 원치 않는 패턴 제거

### 3단계: 중복 관계 방지 로직 강화
**목표**: 동일한 관계의 중복 생성 방지

**적용 내용**:
- 컴포넌트 ID 기반 중복 확인 로직 개선
- 전역 중복 방지 메커니즘 강화
- 관계 생성 전 유효성 검증 추가

**효과**: calls 관계 수의 부풀림 방지

### 4단계: 기본 메서드 필터링 강화
**목표**: toString(), equals() 등 공통 메서드와 getter/setter 제외

**적용 내용**:
- Object 클래스 기본 메서드 목록 정리
- getter/setter 패턴 정규식 컴파일로 성능 향상
- 필터링 함수 분리: `_is_object_method()`, `_is_getter_setter()`
- 유틸리티 메서드 필터링 추가

**효과**: 비즈니스 로직과 무관한 노이즈 제거

## 개선 결과

### 분석 통계
- **총 관계 수**: 946개
- **calls 관계 수**: 413개 (43.7%)
- **기타 관계**: dependency(240), imports(221), foreign_key(52), implements(20)

### Calls 관계 품질 개선
**개선 전 예상 문제점**:
- Java 키워드(if, for, while 등)가 메서드 호출로 잘못 인식
- 생성자 호출, 타입 캐스팅이 calls 관계로 생성
- toString(), equals() 등 기본 메서드가 노이즈로 포함
- 동일한 메서드 호출이 중복으로 기록

**개선 후 결과**:
- 의미있는 calls 관계만 생성됨
- 예시: `MixedErrorController -> MixedErrorService`, `ProductServiceImpl -> ProductMapper`
- Java 키워드나 기본 메서드로 인한 노이즈 제거
- 중복 관계 방지로 정확한 관계 수 반영

### 성능 개선
- 정규식 컴파일로 패턴 매칭 성능 향상
- 필터링 함수 분리로 코드 재사용성 증대
- 전역 중복 방지로 불필요한 DB 작업 감소

## 결론

4가지 개선안 적용으로 calls 관계의 정확도가 크게 향상되었습니다:

1. **정확성 향상**: Java 키워드와 기본 메서드 필터링으로 의미있는 관계만 추출
2. **노이즈 제거**: 생성자 호출, 타입 캐스팅 등 원치 않는 패턴 제거
3. **중복 방지**: 동일한 관계의 중복 생성 방지
4. **성능 최적화**: 정규식 컴파일과 함수 분리로 처리 속도 향상

이러한 개선으로 실제 비즈니스 로직의 메서드 호출 관계를 더 정확하게 파악할 수 있게 되었습니다.

## 권장사항

1. **정기적 검증**: 새로운 소스 코드 패턴에 대한 필터링 규칙 업데이트
2. **성능 모니터링**: 대용량 프로젝트에서의 분석 성능 추적
3. **사용자 피드백**: 분석 결과의 정확도에 대한 사용자 피드백 수집
4. **확장성 고려**: 다른 프로그래밍 언어 지원 시 유사한 개선안 적용

---
*보고서 생성일시: 2025-01-27*
*분석 대상: sampleSrc 프로젝트*
*총 분석 시간: 0.75초*
