# 샘플소스명세서 - sampleSrc 프로젝트 (Part 2)

## 1. JSP 페이지 분석

### 1.1 사용자 관련 JSP

#### 1.1.1 user/list.jsp
- **경로**: `src/main/webapp/user/list.jsp`
- **기능**: 사용자 목록 표시 및 검색
- **주요 특징**:
  - **검색 폼**: 이름, 이메일, 상태별 검색
  - **사용자 목록 테이블**: ID, 사용자명, 이메일, 이름, 나이, 상태, 사용자 유형, 전화번호, 주소, 생성일
  - **상태별 색상 구분**: 활성(녹색), 비활성(빨간색)
  - **클라이언트 사이드 검증**: JavaScript를 통한 입력 검증
  - **고급 검색 링크**: 추가 검색 기능 제공
- **JSTL 태그**: 8개 (c:choose, c:when, c:otherwise, c:forEach, c:url, fmt:formatDate)
- **HTML 태그**: 15개 (table, thead, tbody, tr, th, td, form, input, button 등)
- **JavaScript 함수**: 2개 (validateSearch, 폼 제출 이벤트)
- **CSS 클래스**: 4개 (search-form, user-table, status-active, status-inactive)

#### 1.1.2 user/searchResult.jsp
- **경로**: `src/main/webapp/user/searchResult.jsp`
- **기능**: 고급 검색 결과 표시
- **주요 특징**:
  - **복잡한 검색 조건 결과**: 나이 범위, 날짜 범위, 사용자 유형별 결과
  - **결과 테이블**: 검색된 사용자 정보 표시
  - **검색 조건 표시**: 사용된 검색 조건 요약
- **JSTL 태그**: 6개 (c:if, c:forEach, c:url, fmt:formatDate)
- **HTML 태그**: 12개 (table, div, span, a 등)
- **JavaScript 함수**: 1개 (테이블 정렬 기능)
- **CSS 클래스**: 3개 (table, sortable, highlight)

#### 1.1.3 user/typeList.jsp
- **경로**: `src/main/webapp/user/typeList.jsp`
- **기능**: 사용자 유형별 목록 표시
- **주요 특징**:
  - **유형별 필터링**: 특정 사용자 유형의 사용자만 표시
  - **통계 정보**: 유형별 사용자 수 표시
  - **상세 정보**: 각 사용자의 상세 정보 표시
- **JSTL 태그**: 8개 (c:choose, c:when, c:forEach, c:set, c:url, fmt:formatDate)
- **HTML 태그**: 10개 (table, div, span, select 등)
- **JavaScript 함수**: 2개 (테이블 행 클릭 이벤트)
- **CSS 클래스**: 2개 (table, clickable)

#### 1.1.4 user/error.jsp
- **경로**: `src/main/webapp/user/error.jsp`
- **기능**: 사용자 관련 에러 페이지
- **주요 특징**:
  - **에러 메시지 표시**: 사용자에게 친화적인 에러 메시지
  - **복구 옵션**: 홈으로 돌아가기, 다시 시도하기 버튼
- **JSTL 태그**: 4개 (c:if, c:choose, c:when, c:otherwise)
- **HTML 태그**: 8개 (div, p, a, button 등)
- **JavaScript 함수**: 1개 (에러 메시지 표시)
- **CSS 클래스**: 2개 (error, message)

### 1.2 상품 관련 JSP

#### 1.2.1 product/list.jsp
- **경로**: `src/main/webapp/product/list.jsp`
- **기능**: 상품 목록 표시
- **주요 특징**:
  - **검색 폼**: 상품명, 카테고리, 상태별 검색
  - **상품 목록 테이블**: 상품ID, 상품명, 가격, 재고, 상태, 생성일
  - **카테고리별 필터링**: 전자제품, 의류, 도서 등
  - **고급 검색 링크**: 추가 검색 기능 제공
- **JSTL 태그**: 6개 (c:forEach, c:url, fmt:formatNumber, fmt:formatDate)
- **HTML 태그**: 10개 (table, div, span, a 등)
- **JavaScript 함수**: 1개 (상품 필터링)
- **CSS 클래스**: 3개 (table, product, filter)

#### 1.2.2 product/searchResult.jsp
- **경로**: `src/main/webapp/product/searchResult.jsp`
- **기능**: 상품 검색 결과 표시
- **주요 특징**:
  - **복잡한 검색 조건 결과**: 가격 범위, 재고 범위, 카테고리별 결과
  - **결과 테이블**: 검색된 상품 정보 표시
  - **정렬 기능**: 가격, 재고, 이름별 정렬
- **JSTL 태그**: 5개 (c:if, c:forEach, c:url, fmt:formatNumber)
- **HTML 태그**: 8개 (table, div, span 등)
- **JavaScript 함수**: 1개 (결과 정렬)
- **CSS 클래스**: 2개 (table, result)

### 1.3 에러 관련 JSP

#### 1.3.1 error/syntaxError.jsp
- **경로**: `src/main/webapp/error/syntaxError.jsp`
- **기능**: 문법 오류가 수정된 정상 JSP 페이지
- **주요 특징**:
  - **정상적인 JSTL 사용**: 올바른 태그 구조
  - **사용자 정보 표시**: 정상적인 데이터 바인딩
  - **현재 시간 표시**: JavaScript를 통한 동적 시간 표시
- **JSTL 태그**: 6개 (c:if, c:forEach, fmt:formatDate)
- **HTML 태그**: 12개 (table, div, p, a 등)
- **JavaScript 함수**: 1개 (현재 시간 표시)
- **CSS 클래스**: 3개 (user-info, success, error)

#### 1.3.2 mixed/partialError.jsp
- **경로**: `src/main/webapp/mixed/partialError.jsp`
- **기능**: 정상 부분과 오류 부분이 섞여있는 JSP
- **주요 특징**:
  - **혼합된 코드**: 정상 코드와 오류 코드가 함께 존재
  - **오류 패턴**:
    - 잘못된 EL 표현식: `${user.name.}` (점 뒤에 속성명 없음)
    - 태그 닫기 누락: `c:choose` 태그 닫기 누락
    - 정의되지 않은 변수 참조: `userList` 변수 참조
- **JSTL 태그**: 8개 (정상 5개 + 오류 3개)
- **총 청크**: 11개 (정상 8개 + 오류 3개)

## 2. MyBatis XML 매퍼 분석

### 2.1 UserMapper.xml

#### 2.1.1 기본 쿼리
- **selectUserById**: ID로 사용자 조회
  ```xml
  <select id="selectUserById" parameterType="long" resultType="com.example.model.User">
      SELECT * FROM users WHERE id = #{id}
  </select>
  ```

#### 2.1.2 동적 쿼리
- **selectUsersByCondition**: 조건부 사용자 조회
  - 다이나믹 요소: name, email, status 조건
  - `<where>`, `<if>` 태그 활용
  - LIKE 검색 지원

- **selectUsersByAdvancedCondition**: 고급 조건부 사용자 조회
  - 복잡한 JOIN: users + user_types 테이블
  - 다이나믹 요소: userType, minAge, maxAge, startDate, endDate, statusList
  - `<foreach>` 태그를 통한 IN 절 처리

#### 2.1.3 CRUD 쿼리
- **updateUserDynamic**: 동적 사용자 업데이트
  - `<set>` 태그를 통한 동적 SET 절 생성
  - 필요한 컬럼만 업데이트

- **insertUserDynamic**: 동적 사용자 삽입
  - `<trim>` 태그를 통한 동적 INSERT 절 생성
  - useGeneratedKeys="true"로 자동 증가 키 처리

- **deleteUsersByCondition**: 조건부 사용자 삭제
  - 다양한 조건에 따른 삭제 (상태, 유형, 날짜)

- **countUsersByCondition**: 동적 COUNT 쿼리
  - 조건에 따른 사용자 수 카운트

### 2.2 ProductMapper.xml

#### 2.2.1 기본 쿼리
- **selectProductById**: ID로 상품 조회
- **selectProductsByCategory**: 카테고리별 상품 조회

#### 2.2.2 동적 쿼리
- **selectProductsByCondition**: 조건부 상품 조회
  - 다이나믹 요소: name, category, status, delYn 조건

- **selectProductsByAdvancedCondition**: 고급 조건부 상품 조회
  - 복잡한 JOIN: products + categories + brands 테이블
  - 다이나믹 요소: categoryId, brandId, minPrice, maxPrice, minStock, maxStock, statusList

#### 2.2.3 CRUD 쿼리
- **updateProductStock**: 재고 업데이트
  - 재고 수량 증감 처리

- **updateProductDynamic**: 동적 상품 업데이트
  - `<set>` 태그를 통한 동적 SET 절 생성

- **insertProductDynamic**: 동적 상품 삽입
  - `<trim>` 태그를 통한 동적 INSERT 절 생성

- **deleteProductsByCondition**: 조건부 상품 삭제
  - 논리 삭제 (del_yn = 'Y') 처리

- **countProductsByCondition**: 동적 COUNT 쿼리

### 2.3 다이나믹 쿼리 패턴 분석

#### 2.3.1 주요 다이나믹 태그
- **`<if>`**: 조건부 쿼리 생성
- **`<where>`**: WHERE 절 자동 생성 (AND 제거)
- **`<set>`**: SET 절 자동 생성 (쉼표 제거)
- **`<foreach>`**: 반복 처리 (IN 절, VALUES 절)
- **`<trim>`**: 접두사/접미사 제거
- **`<choose>`, `<when>`, `<otherwise>`**: 조건 분기

#### 2.3.2 복잡한 쿼리 패턴
- **JOIN 쿼리**: 여러 테이블 간의 관계 조회
- **서브쿼리**: 중첩된 쿼리 구조
- **UNION**: 여러 쿼리 결과 결합
- **윈도우 함수**: ROW_NUMBER(), RANK() 등

## 3. 검증 프로세스

### 3.1 파서 검증 플로우

#### 3.1.1 검증 단계
1. **소스 파일 파싱**: Java, JSP, XML 파일 분석
2. **메타데이터 추출**: 클래스, 메서드, 쿼리, 태그 정보 추출
3. **메타디비 저장**: 추출된 정보를 데이터베이스에 저장
4. **명세서 비교**: 명세서 기준값과 메타디비 결과 비교
5. **오차율 계산**: 과소추출, 과다추출, 파일별 오차 계산
6. **검증 결과 생성**: 성공/실패 판정 및 개선 제안

#### 3.1.2 검증 기준
- **과소추출**: 0% (누락 없음)
- **과다추출**: 10% 이내 허용
- **파일별 오차**: 10% 이내 허용
- **오류 감지**: 100% (모든 신택스 오류 감지)

### 3.2 검증 체크리스트

#### 3.2.1 Java 파서 검증
- [ ] 클래스 인식 (16개 클래스)
- [ ] 메서드 인식 (77개 메서드)
- [ ] 어노테이션 인식 (59개 어노테이션)
- [ ] 필드 인식 (35개 필드)
- [ ] 오류 감지 (4개 신택스 오류)

#### 3.2.2 JSP 파서 검증
- [ ] JSTL 태그 인식 (51개 태그)
- [ ] HTML 태그 인식 (75개 태그)
- [ ] JavaScript 인식 (9개 함수)
- [ ] CSS 인식 (19개 클래스)
- [ ] 오류 감지 (3개 신택스 오류)

#### 3.2.3 SQL 파서 검증
- [ ] MyBatis 쿼리 인식 (31개 쿼리)
- [ ] 다이나믹 쿼리 인식 (45개 다이나믹 요소)
- [ ] 테이블명 추출
- [ ] 컬럼명 추출
- [ ] 오류 감지 (2개 신택스 오류)

### 3.3 성능 테스트

#### 3.3.1 파싱 성능
- **파일별 파싱 시간**: Java, JSP, XML 파일별 파싱 시간 측정
- **메모리 사용량**: 파싱 중 메모리 사용량 측정
- **대용량 처리**: 많은 파일 처리 시 성능 측정

#### 3.3.2 정확도 테스트
- **정상 케이스 정확도**: 정상 코드 파싱 정확도 측정
- **오류 케이스 정확도**: 오류 코드 감지 정확도 측정
- **복잡한 구조 정확도**: 복잡한 코드 구조 파싱 정확도 측정

## 4. 개선 제안

### 4.1 파서 개선 방향

#### 4.1.1 Java 파서 개선
- **복잡한 어노테이션 처리**: 중첩된 어노테이션, 배열 어노테이션 처리
- **제네릭 타입 처리**: 복잡한 제네릭 타입 파싱 개선
- **람다 표현식 처리**: Java 8+ 람다 표현식 파싱
- **스트림 API 처리**: Stream API 사용 패턴 파싱

#### 4.1.2 JSP 파서 개선
- **커스텀 태그 처리**: 사용자 정의 태그 파싱
- **EL 표현식 처리**: 복잡한 EL 표현식 파싱
- **JavaScript 코드 분석**: 인라인 JavaScript 코드 분석
- **CSS 코드 분석**: 인라인 CSS 코드 분석

#### 4.1.3 SQL 파서 개선
- **복잡한 다이나믹 쿼리 처리**: 중첩된 다이나믹 쿼리 파싱
- **서브쿼리 처리**: 복잡한 서브쿼리 구조 파싱
- **윈도우 함수 처리**: 분석 함수, 윈도우 함수 파싱
- **CTE 처리**: Common Table Expression 파싱

### 4.2 오류 처리 개선

#### 4.2.1 오류 감지 정확도 향상
- **문법 오류 감지**: 더 정확한 문법 오류 감지
- **의미 오류 감지**: 의미적 오류 감지 기능 추가
- **오류 위치 정보**: 정확한 오류 위치 정보 제공
- **오류 메시지 품질**: 사용자 친화적인 오류 메시지

#### 4.2.2 오류 복구 능력 향상
- **부분적 파싱**: 오류 발생 시 부분적 파싱 계속 진행
- **오류 발생 시 계속 진행**: 하나의 오류로 전체 파싱 중단 방지
- **오류 로그 품질**: 상세하고 유용한 오류 로그 제공

## 5. 결론

### 5.1 주요 특징
1. **현실적인 복잡성**: 실제 프로젝트 수준의 복잡한 구조
2. **포괄적 검증**: Spring MVC, MyBatis, JSP, Oracle DB 전체 스택
3. **오류 감지 테스트**: 7개의 의도적 신택스 오류 포함
4. **다양한 표현 방식**: 정상 코드와 오류 코드의 혼합

### 5.2 검증 성공 기준
1. **과소추출**: 0% (누락 없음)
2. **과다추출**: 10% 이내
3. **파일별 오차**: 10% 이내
4. **오류 감지**: 100% (모든 신택스 오류 감지)

### 5.3 다음 단계
1. **실제 검증 실행**: 명세서 기반 파서 검증 수행
2. **결과 분석**: 검증 결과 분석 및 개선점 도출
3. **파서 개선**: 검증 결과 기반 파서 개선 구현
4. **재검증**: 개선된 파서로 재검증 수행

이 명세서는 파서의 견고성과 정확성을 종합적으로 검증할 수 있는 완전한 테스트 베드 역할을 합니다.

---

**Part 1과 Part 2를 함께 사용하여 완전한 파서 검증을 수행할 수 있습니다.**
