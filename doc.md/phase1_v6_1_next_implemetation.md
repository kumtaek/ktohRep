# Source Analyzer 개발 현황 목록

본 문서는 Source Analyzer 프로젝트의 개발된 기능과 미개발 또는 추가 개선이 필요한 기능들을 요약하여 정리합니다.

## 1. 개발 완료된 기능

### 1.1. 핵심 파서 및 분석 기능

* **MyBatis `<include>` 및 `<bind>` 구문 처리**: MyBatis XML 내 `<sql id="">` 블록 캐싱 및 `<include refid="">` 해결 로직 구현. `<bind>` 변수명, 값, 파일경로, 라인번호 추적 및 SQL 내 `#{변수명}` 사용 시 bind 변수로 자동 분류.
* **메서드 호출 관계 해결**: 미해결 메서드 호출 엣지들을 실제 메서드와 연결 (동일 클래스 우선 매칭 후 전역 검색), 해결 성공/실패에 따른 신뢰도 점수 자동 조정.
* **취약점 탐지 결과 저장**: JSP/MyBatis 파서에서 탐지된 취약점 정보를 `VulnerabilityFix` 테이블에 저장하는 파이프라인 구축.
* **보안 취약점 탐지 강화**: OWASP Top 10 기반 10가지 주요 보안 취약점 유형별 테스트 케이스 및 코드 추가 (`VulnerabilityTestService.java`에 구현).
* **코드 복잡도 분석 강화**: 중첩된 조건문, 복잡한 표현식, 동적 문자열 구성 로직을 포함하는 메서드의 복잡도 분석 (`processComplexBusiness()` 메서드에 구현).

### 1.2. 성능 및 안정성

* **증분 분석 기능 구현**: 파일 해시 기반 변경 감지 시스템 구현 및 `--incremental` 플래그 지원으로 변경된 파일만 분석.
* **증분 분석 삭제 파일 처리**: 삭제된 파일 탐지 로직 구현 및 File, Class, Method, SqlUnit, Edge, Join, RequiredFilter, Summary, EnrichmentLog, VulnerabilityFix 등 관련 메타데이터 카스케이딩 정리.
* **크기 기반 파일 처리 전략**: 파일 크기(소형, 중형, 대형)에 따라 해시 계산 또는 mtime 확인 전략을 다르게 적용하여 증분 분석 성능 최적화.
* **Suspect 마킹 시스템**: 신뢰도 기반 분류 (confidence ≥ 0.3: 정상, 0.1 ≤ confidence < 0.3: Suspect 마킹, confidence < 0.1: 필터링). Suspect 결과는 `_SUSPECT` 접미사 추가.
* **신뢰도 임계값 필터링 구현**: `config.yaml`의 `confidence_threshold` 설정을 활용하여 낮은 신뢰도를 가진 엣지 자동 필터링.
* **로깅 시스템 통합**: 콘솔 및 파일 로깅 일원화, 설정 주입을 통한 레벨/포맷/파일 경로 제어.

### 1.3. 유연성 및 유지보수성

* **설정 가능한 DB 스키마 매칭**: `config.yaml`의 `database.default_schema` 설정을 통한 동적 스키마 매칭 (하드코딩된 'SAMPLE' 스키마 제거).
* **모듈 경로 및 import 정리**: `main.py`의 PYTHONPATH 설정 수정, 신뢰도 계산기 클래스명/import 경로 일원화, `ParseResult` 클래스명 충돌 해결.
* **폴더 구조 재편성**: Phase2 개발을 위해 `phase1/src`로 소스 이동 및 `phase2` 폴더 생성.

### 1.4. 테스트 환경

* **샘플 소스 확장**: Java, JSP, MyBatis XML 파일 종류별로 3개씩 분리 및 내용 추가하여 테스트 커버리지 향상.
* **테스트 환경 구축**: DB 스키마 업데이트, 22개의 종합 테스트 케이스 문서화 (`testcase/testcase.md`).

## 2. 미개발 또는 추가 개선이 필요한 기능

        [TODO1] - 1차 개발, [TODO2] - 2차 개발

### 2.1. 파서 정확성 및 확장성

* **[TODO2] PL/SQL 코드에 대한 지원 부족**: Oracle DB 내 저장 프로시저/함수(PL/SQL)에 대한 메타정보 수집 및 호출 관계 분석. (`ALL_PROCEDURES.CSV` 및 SP/SF 소스 파일 분석 포함)
* **병렬 처리 경로 단일화**: asyncio 기반 비동기 처리와 ThreadPool 기반 처리 로직의 통합.
* **Java AST/심볼 해석**: 상속/오버로드/람다/스트림 API 등 현대 Java 문법에 대한 정밀 AST 분석 및 심볼 해석.
* **[TODO2] 정규표현식 의존 완화**: AST 기반으로 스크립틀릿/동적 문자열에서의 SQL을 최대한 구조화하여 정규표현식 의존도 낮추기.
* **[TODO2] Tree-Sitter 기반 다양한 언어 파싱**: JavaParser를 보완하기 위한 Tree-Sitter 기반 파서 도입 (Java, JSP, JavaScript/TypeScript, Python 등 다양한 언어 지원).
* **[TODO] ANTLR 기반 SQL/PL-SQL 파서 확장**: Oracle PL/SQL 및 동적 SQL 처리를 위한 `antlr-plsql` 및 SQLGlot 병행 도입.
* **TypeScript/프론트엔드 분석**: 컴포넌트, props, state, `import`/`require` 구문 등을 분석하여 웹 프론트엔드 애플리케이션 구조 및 의존성 파악.
* **[TODO1] 시퀀스다이어그램, 컴포넌트다이어그램, ERD, 구성요소간 연관도 등의 시각화를 할 수 있도록 메타정보 보완**: 시각화를 위해 필요하다면 메타정보 보강.

### 2.2. LLM 활용 및 지능형 분석

* **[TODO2] LLM 기반 지능형 분석 및 저장**: LLM을 통한 메타정보 보강, 소스/쿼리에서 오류 발생 가능 부분, 테이블 설계 문제점 등을 지능적으로 파악하여 별도 메타 테이블에 저장.
* **[TODO2] 메소드별, 테이블,컬럼,클래스,jsp별 요약**: LLM을 이용한 소스 로직의 의미 이해 및 지능적인 요약 생성.
* **[TODO2] 신뢰도를 구하는 공식 재점검**: 현재 신뢰도 공식에 대한 심층 재점검 및 개선안 도출.
* **[TODO2] DB 사전 보강 코멘트 생성 (LLM 기반)**: LLM에게 컬럼의 역할과 의미를 설명하는 고품질 한글 코멘트 생성 요청 및 `summaries` 테이블에 저장.

### 2.3. 품질 및 보안 분석 고도화

* **[TODO2] 데이터 흐름 분석 (Source to Sink 추적)**: 코드 내 데이터의 이동 경로를 정적으로 추적하여 정밀 영향 평가 및 Taint Analysis 탐지.
* **정교한 코드 품질 메트릭 분석 기능 확장**: PMD의 중복 코드 탐지(CPD), 순환 복잡도 등 다양한 코드 품질 지표 분석 및 `duplicates`, `duplicate_instances` 테이블 저장.
* **SAST 도구 통합**: CodeQL이나 Semgrep과 같은 오픈소스 SAST 도구를 오프라인 모드로 실행하여 SQL Injection, XSS, 경로 조작 등 다양한 취약 패턴 정적 분석 및 LLM 기반 수정 제안 생성.

### 2.4. 2단계 (RAG 및 오케스트레이터) 기능

* **LLM 및 AST 등 대형 기능 미도입**: LLM을 통한 메타정보 보강이나 Java/SQL 구문의 정밀 AST 파싱 등은 Phase2 혹은 6차 이후 단계에서 고려할 확장 기능.
* **하이브리드 임베딩 + 교차 인코더**: BGE-M3, BM25, reranker를 결합한 하이브리드 검색 시스템 구축.
* **변경 분석 기능**: 수정 전/후 비교를 통한 변경 내역 요약 및 수정에 대한 영향에 대한 지능적 분석 기능 개발.
* **UI/시각화 대시보드**: 의존성 그래프, 코드 메트릭 차트, ERD, 구성요소간 연관도 등 시각화.
* **분석 시간 오래 걸리므로 개별 작업을 나눠서 수행할 수 있도록 개선**: 분석 작업을 개별 단위로 나누고 오케스트레이션하여 전체 분석 시간 단축.

### 2.5. 기타 개선 사항

* **신뢰도 낮은 결과의 활용 제한**: 임계치 미만의 결과를 필터링하는 방식 외에, LLM 보강 등 추가 활용 방안 모색 (현재 Suspect 마킹으로 일부 보존).
* **병렬 처리 경로 이원화 지속**: asyncio 기반 비동기 처리와 ThreadPool 기반 처리 로직의 통합.
* **ALL_PROCEDURES.CSV 및 SP/SF 소스 파일 분석**: DB_SCHEMA 폴더에 업로드된 SP/SF 소스 파일을 분석하여 메타정보 생성.
* **분석 시간 오래 걸리므로 개별 작업을 나눠서 수행할 수 있도록 개선**: 분석 작업을 개별 단위로 나누고 오케스트레이션하여 전체 분석 시간 단축.
* **메소드별, 테이블,컬럼,클래스,jsp별 요약이 지능적으로 잘되나? 정확성을 개선방법은 있는가? LLM을 이용해서 소스상에 로직의 의미를 이해해서 요약을 하고 있는가? 시간이 오래걸리더라도 정확성을 높히는데 우선할 것.**: LLM 기반 요약 및 정확성 개선.
* **신뢰도를 구하는 공식은 신뢰성이 있는가? 심층 재점검해보고 개선안을 찾아보자.**
* **LLM 기반 지능형 분석 및 저장**: LLM을 통한 메타정보 보강, 오류/성능 이슈 파악.
* **변경 분석 기능**: 수정 전/후 비교, 변경 내역 요약 및 영향 분석.
- **[TODO1] 시각화**: 의존성 그래프
- **[TODO2] 시각화**: 코드 메트릭 차트 등 시각화.
- **[TODO1] 시각화**: 시퀀스다이어그램, 컴포넌트다이어그램, ERD 생성.  뷰어 개발.  확대/축소, 드래그하여 무브 가능. 화일, 테이블 선택하여 생성 가능하도록 개발하고, PNG화일로 생성가능.
* **[TODO2] 데이터 흐름 분석 (Source to Sink 추적)**: 코드 내 데이터 이동 경로 추적.
* **정교한 코드 품질 메트릭 분석 기능 확장**: PMD CPD, 순환 복잡도 등 품질 지표 분석.
* **Java AST/심볼 해석**: 상속/오버로드/람다/스트림 API 등 정밀 모델링.
* **정규표현식 의존 완화**: AST 기반으로 스크립틀릿/동적 문자열 SQL 구조화.
* **Tree-Sitter 기반 다국어 파싱**: JavaParser 보완, 다양한 언어 증분 파싱.
* **ANTLR 기반 SQL/PL-SQL 파서 확장**: Oracle PL/SQL, 동적 SQL 정밀 파싱.
* **TypeScript/프론트엔드 분석**: 컴포넌트, props, state, import/require 구문 분석.
* **하이브리드 임베딩 + 교차 인코더**: BGE-M3, BM25, reranker 결합 검색.
* **SAST 도구 통합**: CodeQL/Semgrep 오프라인 모드 연동, 취약점 수정 제안.
