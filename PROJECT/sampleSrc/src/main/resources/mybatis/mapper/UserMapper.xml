<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.mapper.UserMapper">

    <!-- 사용자 ID로 사용자 정보를 조회하는 쿼리 -->
    <select id="selectUserById" parameterType="String" resultType="com.example.model.User">
        SELECT
            user_id AS id,
            user_name AS name,
            user_email AS email,
            status
        FROM
            users
        WHERE
            user_id = #{userId}
    </select>

    <!-- 모든 활성 사용자 목록을 조회하는 쿼리 -->
    <select id="selectActiveUsers" resultType="com.example.model.User">
        SELECT
            user_id AS id,
            user_name AS name,
            user_email AS email,
            status
        FROM
            users
        WHERE
            del_yn = 'N'
        ORDER BY
            user_name
    </select>

    <!-- 새로운 사용자 정보를 삽입하는 쿼리 -->
    <insert id="insertUser" parameterType="com.example.model.User">
        INSERT INTO users (
            user_id,
            user_name,
            user_email,
            status,
            reg_date
        ) VALUES (
            #{id},
            #{name},
            #{email},
            #{status},
            NOW()
        )
    </insert>

    <!-- 사용자 상태를 업데이트하는 쿼리 (UserService에서 호출될 가상 메소드) -->
    <update id="updateUserStatus" parameterType="map">
        UPDATE users
        SET
            status = #{newStatus},
            mod_date = NOW()
        WHERE
            user_id = #{userId}
    </update>

    <!-- 동적 쿼리 실행 예시 (보안 취약점 예시) -->
    <select id="executeDynamicQuery" parameterType="String" resultType="com.example.model.User">
        ${_parameter}
    </select>

</mapper>