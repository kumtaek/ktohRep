# 파싱정확도 개선결과 비교분석 보고서

## 📋 개요

**작업 일시**: 2025-09-04 19:45  
**목적**: A파일 개선안 적용 후 파싱 정확도 검증 및 이전 조사 결과와 비교 분석  
**기준**: '파일별 메소드, 쿼리 개수 조사 결과.md' vs 메타DB 결과

## 🔍 개선 전후 비교

### **개선 전 (이전 실행)**
- **Files**: 31개
- **Classes**: 16개
- **Methods**: 40개
- **SQL Units**: 30개
- **Chunks**: 134개
- **Edges**: 0개

### **개선 후 (현재 실행)**
- **Files**: 31개
- **Classes**: 16개
- **Methods**: 40개
- **SQL Units**: 30개
- **Chunks**: 134개
- **Edges**: 0개

## 🚨 핵심 문제점 발견

### **1. 파싱 결과 변화 없음**
- **문제**: A파일의 개선안을 적용했지만 파싱 결과가 전혀 개선되지 않음
- **원인**: 실제 코드 수정을 하지 않고 메타DB만 재생성했기 때문

### **2. 누락된 클래스들 여전히 누락**
- **이전 조사**: 20개 Java 파일, 71개 메소드
- **메타DB**: 16개 클래스, 40개 메소드
- **누락**: OrderService, UserService, ProductService, VulnerabilityTestService

### **3. Edge 관계 여전히 0개**
- **문제**: 메서드 호출 관계가 전혀 저장되지 않음
- **원인**: A파일에서 지적한 Edge 저장 로직 문제가 해결되지 않음

## 📊 상세 비교 분석

### **Java 클래스 비교**

| 클래스명 | 이전 조사 | 메타DB | 상태 |
|---------|----------|--------|------|
| ApiController | ✅ | ✅ | 정상 |
| DatabaseConfig | ✅ | ✅ | 정상 |
| SecurityConfig | ✅ | ✅ | 정상 |
| MainController | ✅ | ✅ | 정상 |
| OrderController | ✅ | ✅ | 정상 |
| PaymentController | ✅ | ✅ | 정상 |
| IntegratedMapper | ✅ | ✅ | 정상 |
| IntegratedService | ✅ | ✅ | 정상 |
| ListService | ✅ | ✅ | 정상 |
| OverloadService | ✅ | ✅ | 정상 |
| ListServiceImpl1 | ✅ | ✅ | 정상 |
| DateUtil | ✅ | ✅ | 정상 |
| Texts | ✅ | ✅ | 정상 |
| **OrderService** | ✅ | ❌ | **누락** |
| **UserService** | ✅ | ❌ | **누락** |
| **ProductService** | ✅ | ❌ | **누락** |
| **VulnerabilityTestService** | ✅ | ❌ | **누락** |
| OrderMapper | ✅ | ✅ | 정상 |
| ProductMapper | ✅ | ✅ | 정상 |
| UserMapper | ✅ | ✅ | 정상 |

### **누락된 클래스들 상세 분석**

#### **1. OrderService.java**
- **이전 조사**: 6개 메소드 (calculateOrderTotal, getOrdersByStatus, generateOrderReport 등)
- **메타DB**: 클래스 자체가 누락
- **원인**: Java 파서가 해당 파일을 파싱하지 못함

#### **2. UserService.java**
- **이전 조사**: 6개 메소드 (getUserById, getActiveUsers, createUser 등)
- **메타DB**: 클래스 자체가 누락
- **원인**: Java 파서가 해당 파일을 파싱하지 못함

#### **3. ProductService.java**
- **이전 조사**: 5개 메소드 (getProductList, getProductDetails, searchProducts 등)
- **메타DB**: 클래스 자체가 누락
- **원인**: Java 파서가 해당 파일을 파싱하지 못함

#### **4. VulnerabilityTestService.java**
- **이전 조사**: 9개 메소드 (보안 취약점 테스트용)
- **메타DB**: 클래스 자체가 누락
- **원인**: Java 파서가 해당 파일을 파싱하지 못함

## 🔧 근본 원인 분석

### **1. Java 파서 문제**
- **문제**: javalang 라이브러리가 특정 파일들을 파싱하지 못함
- **원인**: 파일 인코딩, 문법 오류, 또는 javalang 라이브러리 한계
- **해결 필요**: 파서 로직 개선 또는 백업 파서 강화

### **2. Edge 저장 로직 문제**
- **문제**: 메서드 호출 관계가 전혀 저장되지 않음
- **원인**: A파일에서 지적한 `src_id=None, dst_id=None` 문제
- **해결 필요**: Edge 저장 시점에서 즉시 ID 해결 로직 구현

### **3. 파싱 결과 검증 부족**
- **문제**: 파싱 실패를 감지하지 못함
- **원인**: 파싱 결과 검증 로직 부재
- **해결 필요**: 파싱 전후 비교 및 누락 감지 시스템 구축

## 💡 개선 방안

### **우선순위 1: 누락된 파일들 개별 파싱 테스트**
1. OrderService.java, UserService.java, ProductService.java, VulnerabilityTestService.java 개별 파싱 테스트
2. 파싱 실패 원인 분석 (인코딩, 문법 오류, javalang 한계)
3. 백업 파서(정규식)로 누락된 파일들 보완

### **우선순위 2: Edge 저장 로직 수정**
1. `phase1/database/metadata_engine.py`의 Edge 저장 로직 수정
2. `src_id`, `dst_id` 즉시 해결 로직 구현
3. 메서드 호출 관계 정상 저장 확인

### **우선순위 3: 파싱 결과 검증 시스템 구축**
1. 파싱 전후 비교 로직 추가
2. 누락된 파일/클래스 자동 감지
3. 파싱 실패 시 경고 및 백업 파서 실행

## 📈 예상 개선 효과

### **파싱 정확도 개선**
- **현재**: 16/20 클래스 (80%)
- **개선 후**: 20/20 클래스 (100%)

### **메소드 수 개선**
- **현재**: 40개 메소드
- **개선 후**: 71개 메소드 (이전 조사와 동일)

### **Edge 관계 복구**
- **현재**: 0개
- **개선 후**: 메서드 호출 관계 정상 저장

## 🎯 다음 단계

1. **즉시 실행**: 누락된 4개 파일 개별 파싱 테스트
2. **코드 수정**: Edge 저장 로직 및 파싱 검증 로직 구현
3. **검증**: 개선 후 이전 조사 결과와 100% 일치 확인

## 📊 결론

**현재 상태**: 파싱 정확도 80% (16/20 클래스)  
**목표**: 파싱 정확도 100% (20/20 클래스)  
**핵심 문제**: Java 파서의 특정 파일 파싱 실패 및 Edge 저장 로직 문제  
**해결 필요**: 실제 코드 수정을 통한 근본적 개선

**이전 조사 결과가 정확하며, 메타DB 파싱 결과를 개선해야 합니다.**

