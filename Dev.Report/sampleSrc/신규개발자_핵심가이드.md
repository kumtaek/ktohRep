# ğŸš€ ì‹ ê·œ ê°œë°œì í•µì‹¬ ê°€ì´ë“œ

## ğŸ“‹ ì£¼ìš” ë¹„ì¦ˆë‹ˆìŠ¤ í”Œë¡œìš°

### ğŸ›’ ì£¼ë¬¸ ìƒì„± í”Œë¡œìš°
```
HTTP POST /api/orders
â†“
OrderController.createOrder()  (32ë¼ì¸)
â”œâ”€â”€ UserService.getUserById()     // ì‚¬ìš©ì ê²€ì¦
â”œâ”€â”€ ProductService.getProductById() // ìƒí’ˆ/ì¬ê³  ê²€ì¦  
â””â”€â”€ OrderService.createOrder()     // ì£¼ë¬¸ ìƒì„±
    â””â”€â”€ OrderMapper.insertOrder() // DB ì €ì¥
```

### ğŸ” ì£¼ë¬¸ ì¡°íšŒ í”Œë¡œìš°
```
HTTP GET /api/orders/{id}
â†“
OrderController.getOrderById() (95ë¼ì¸)
â””â”€â”€ OrderService.getOrderById()
    â””â”€â”€ OrderMapper.selectOrderById() // JOIN ì¿¼ë¦¬
```

### ğŸ’° ê²°ì œ ì²˜ë¦¬ í”Œë¡œìš°
```
HTTP POST /api/payments/process
â†“
PaymentController.processPayment() (29ë¼ì¸)
â””â”€â”€ PaymentService.processPayment()
    â”œâ”€â”€ OrderService.validateOrder()  // ì£¼ë¬¸ ìœ íš¨ì„±
    â”œâ”€â”€ PaymentGateway.charge()      // ì™¸ë¶€ ê²°ì œ
    â””â”€â”€ OrderService.updateStatus()   // ìƒíƒœ ì—…ë°ì´íŠ¸
```

## ğŸ” ë¹ ë¥¸ ì°¾ê¸° ê°€ì´ë“œ

### "XX ê¸°ëŠ¥ ìˆ˜ì •í•˜ë ¤ë©´ ì–´ëŠ íŒŒì¼?"

| ê¸°ëŠ¥ | Controller | Service | Mapper/XML |
|------|------------|---------|------------|
| ì£¼ë¬¸ ê´€ë¦¬ | `OrderController.java` | `OrderService.java` | `OrderMapper.xml` |
| ê²°ì œ ì²˜ë¦¬ | `PaymentController.java` | `PaymentService.java` | `PaymentMapper.xml` |
| ì‚¬ìš©ì ê´€ë¦¬ | `MainController.java` | `UserService.java` | `UserMapper.xml` |
| API ê³µí†µ | `ApiController.java` | - | - |

### ì—ëŸ¬ ë°œìƒì‹œ ì²´í¬ í¬ì¸íŠ¸
1. **400 ì—ëŸ¬** â†’ Controller íŒŒë¼ë¯¸í„° ê²€ì¦
2. **500 ì—ëŸ¬** â†’ Service ë¡œì§ or DB ì¿¼ë¦¬ í™•ì¸
3. **DB ì—ëŸ¬** â†’ MyBatis XML ì¿¼ë¦¬ ê²€í† 
4. **íŠ¸ëœì­ì…˜ ì—ëŸ¬** â†’ @Transactional ì„¤ì • í™•ì¸

## âš¡ ìì£¼ ì“°ëŠ” ì¿¼ë¦¬/API ì°¸ì¡°

### ğŸ“Œ ê³µí†µ CRUD íŒ¨í„´

#### ë‹¨ê±´ ì¡°íšŒ (ID ê¸°ë°˜)
```xml
<select id="selectById" parameterType="String" resultType="VOí´ë˜ìŠ¤">
    SELECT <include refid="ê¸°ë³¸ì»¬ëŸ¼ë“¤"/>
    FROM í…Œì´ë¸”ëª…
    WHERE id = #{id} AND del_yn = 'N'
</select>
```

#### ëª©ë¡ ì¡°íšŒ (ì¡°ê±´ ê¸°ë°˜)
```xml
<select id="selectByStatus" parameterType="String" resultType="VOí´ë˜ìŠ¤">
    SELECT <include refid="ê¸°ë³¸ì»¬ëŸ¼ë“¤"/>
    FROM í…Œì´ë¸”ëª…  
    WHERE status = #{status} AND del_yn = 'N'
    ORDER BY created_date DESC
</select>
```

#### JOIN ì¡°íšŒ (ê´€ê³„ í…Œì´ë¸”)
```xml
<select id="selectWithJoin" resultType="VOí´ë˜ìŠ¤">
    SELECT 
        <include refid="ì£¼í…Œì´ë¸”ì»¬ëŸ¼ë“¤"/>,
        <include refid="ê´€ê³„í…Œì´ë¸”ì»¬ëŸ¼ë“¤"/>
    FROM ì£¼í…Œì´ë¸” m
    LEFT JOIN ê´€ê³„í…Œì´ë¸” s ON m.id = s.ì£¼í…Œì´ë¸”_id
    WHERE m.del_yn = 'N'
</select>
```

### ğŸ“Š ìì£¼ ì‚¬ìš©í•˜ëŠ” API ì—”ë“œí¬ì¸íŠ¸

| HTTP ë©”ì„œë“œ | ê²½ë¡œ | ìš©ë„ | Controller:ë¼ì¸ |
|-------------|------|------|----------------|
| GET | `/api/orders` | ì£¼ë¬¸ ëª©ë¡ | OrderController:68 |
| POST | `/api/orders` | ì£¼ë¬¸ ìƒì„± | OrderController:31 |
| GET | `/api/orders/{id}` | ì£¼ë¬¸ ìƒì„¸ | OrderController:95 |
| POST | `/api/payments/process` | ê²°ì œ ì²˜ë¦¬ | PaymentController:29 |
| GET | `/api/payments/{id}/status` | ê²°ì œ ìƒíƒœ | PaymentController:77 |

## ğŸ” ì½”ë“œ ë¦¬ë·° ì²´í¬í¬ì¸íŠ¸

### âœ… í•„ìˆ˜ ì ê²€ ì‚¬í•­

#### 1. **Controller ê³„ì¸µ**
- [ ] `@RestController` + `@RequestMapping` ì„¤ì •
- [ ] íŒŒë¼ë¯¸í„° ê²€ì¦ (`@RequestBody`, `@PathVariable`)
- [ ] ì˜ˆì™¸ ì²˜ë¦¬ (`try-catch` ë˜ëŠ” `@ExceptionHandler`)
- [ ] HTTP ì‘ë‹µ ì½”ë“œ ì ì ˆì„±

#### 2. **Service ê³„ì¸µ** 
- [ ] `@Service` + `@Transactional` ì„¤ì •
- [ ] ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ê²€ì¦ (null ì²´í¬, ê¶Œí•œ í™•ì¸)
- [ ] ì˜ˆì™¸ ë˜ì§€ê¸° (`IllegalArgumentException` ë“±)
- [ ] Mapper í˜¸ì¶œ íŒ¨í„´ ì¼ê´€ì„±

#### 3. **MyBatis XML**
- [ ] SQL injection ë°©ì§€ (`#{parameter}` ì‚¬ìš©)
- [ ] JOIN ì¡°ê±´ ëª…ì‹œì„±
- [ ] `del_yn = 'N'` ì¡°ê±´ í¬í•¨ (ë…¼ë¦¬ ì‚­ì œ)
- [ ] ì»¬ëŸ¼ëª… include í™œìš©

#### 4. **ê³µí†µ íŒ¨í„´**
- [ ] ë„¤ì´ë° ê·œì¹™: `selectById`, `updateStatus`, `deleteById`
- [ ] ë¡œê·¸ ì‚­ì œ ê²€ì¦: `del_yn = 'N'` ì¡°ê±´
- [ ] íŠ¸ëœì­ì…˜ ë²”ìœ„: Service ë‹¨ìœ„
- [ ] ì˜ˆì™¸ ì „íŒŒ: Controllerì—ì„œ ìµœì¢… ì²˜ë¦¬

### ğŸš¨ ìì£¼ ë†“ì¹˜ëŠ” í¬ì¸íŠ¸
1. **NULL ì²´í¬ ëˆ„ë½** â†’ `if (object == null)` ì¶”ê°€
2. **íŠ¸ëœì­ì…˜ ë²”ìœ„ ì• ë§¤** â†’ `@Transactional` ëª…ì‹œ
3. **SQL injection ìœ„í—˜** â†’ `${}` ëŒ€ì‹  `#{}` ì‚¬ìš©
4. **ë…¼ë¦¬ì‚­ì œ ì¡°ê±´ ëˆ„ë½** â†’ `AND del_yn = 'N'` ì¶”ê°€
5. **ì˜ˆì™¸ ì²˜ë¦¬ ìƒëµ** â†’ ì ì ˆí•œ ì˜ˆì™¸ íƒ€ì…ìœ¼ë¡œ ë˜ì§€ê¸°

---
*ìƒì„±ì¼: 2025-09-04*  
*ê¸°ë°˜: sampleSrc í”„ë¡œì íŠ¸ ì†ŒìŠ¤ ë¶„ì„*