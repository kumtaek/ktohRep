# SourceAnalyzer 개발 프로젝트 (Part 1)

## 1. 프로젝트 개요

### 1.1 프로젝트 정보
- **프로젝트명**: sampleSrc
- **분석일시**: 2025-09-05 17:59:51
- **개발목적**: 신규입사자가 소스만 보고 업무파악하는데 어려움을 도와주고자 메타정보를 구축하는 것이고, 이를 이용해 LLM을 이용해서 자연어로 질의 응답을 해주거나, 도움이 되는 문서(e.g. ERD, 컴퍼넌트다이어그램 등)를 생성해 내고자 한다.  아래는 개발,테스트를 위한 샘플 소스이다.  샘플소스의 내용으로 하드코딩된 로직을 개발하면 안되고 동적으로 소스분석하는 로직을 개발해야 한다.
- **프로젝트 유형**: Java, Spring Boot + MyBatis, Oracle, 웹 애플리케이션
- **주요 기능**: 사용자 관리, 상품 관리, 동적 쿼리 처리

### 1.2 기술 스택
- **Backend**: Java, Spring Boot, MyBatis, Oracle
- **Frontend**: JSP, JSTL, JavaScript
- **Database**: Oracle만 사용함
- **Build Tool**: Maven (추정)

### 1.3 프로젝트 구조
```
sampleSrc/
├── src/main/java/com/example/
│   ├── controller/          # 웹 컨트롤러
│   ├── service/            # 비즈니스 로직
│   ├── mapper/             # MyBatis 매퍼 인터페이스
│   └── model/              # 도메인 모델
├── src/main/resources/mybatis/mapper/  # MyBatis XML 매퍼
├── src/main/webapp/        # JSP 뷰 파일
├── db_schema/              # 데이터베이스 스키마 정보
└── config/                 # 설정 파일
```

## 2. 데이터베이스 스키마 분석

### 2.1 테이블 구조

#### 2.1.1 주요 테이블 (SAMPLE 스키마)

##### USERS 테이블
- **목적**: 사용자 정보 저장
- **컬럼**:
  - `ID`: NUMBER, PK, 사용자 고유 식별자
  - `USERNAME`: VARCHAR2(50), NOT NULL, 사용자명 (유니크)
  - `EMAIL`: VARCHAR2(100), NOT NULL, 이메일 주소
  - `PASSWORD`: VARCHAR2(100), NOT NULL, 암호화된 비밀번호
  - `NAME`: VARCHAR2(100), 사용자 실명
  - `AGE`: NUMBER(3), 나이
  - `STATUS`: VARCHAR2(20), 계정 상태 (ACTIVE/INACTIVE)
  - `USER_TYPE`: VARCHAR2(20), 사용자 유형 (NORMAL/PREMIUM/ADMIN)
  - `PHONE`: VARCHAR2(20), 전화번호
  - `ADDRESS`: VARCHAR2(200), 주소
  - `CREATED_DATE`: DATE, 계정 생성일
  - `UPDATED_DATE`: DATE, 정보 수정일

##### PRODUCTS 테이블
- **목적**: 상품 정보 저장
- **컬럼**:
  - `PRODUCT_ID`: VARCHAR2, PK, 상품 고유 식별자
  - `PRODUCT_NAME`: VARCHAR2, NOT NULL, 상품명
  - `DESCRIPTION`: CLOB, 상품 설명
  - `PRICE`: NUMBER, NOT NULL, 가격
  - `STOCK_QUANTITY`: NUMBER, NOT NULL, 재고 수량
  - `STATUS`: VARCHAR2, NOT NULL, 상태
  - `CATEGORY_ID`: VARCHAR2, 분류 ID
  - `BRAND_ID`: VARCHAR2, 브랜드 ID
  - `SUPPLIER_ID`: VARCHAR2, 공급업체 ID
  - `WAREHOUSE_ID`: VARCHAR2, 창고 ID
  - `CREATED_DATE`: DATE, NOT NULL, 생성일
  - `UPDATED_DATE`: DATE, 수정일
  - `DEL_YN`: CHAR, NOT NULL, 삭제 여부

##### USER_TYPES 테이블
- **목적**: 사용자 유형 관리
- **컬럼**:
  - `TYPE_CODE`: VARCHAR2(20), PK, 유형 코드
  - `TYPE_NAME`: VARCHAR2(50), NOT NULL, 유형명
  - `DESCRIPTION`: VARCHAR2(200), 유형 설명

#### 2.1.2 기타 테이블

##### CUSTOMERS 테이블
- **목적**: 고객 정보 관리
- **주요 컬럼**: CUSTOMER_ID, CUSTOMER_NAME, EMAIL, PHONE, ADDRESS

##### ORDERS 테이블
- **목적**: 주문 정보 관리
- **주요 컬럼**: ORDER_ID, CUSTOMER_ID, ORDER_DATE, STATUS, TOTAL_AMOUNT

##### ORDER_ITEMS 테이블
- **목적**: 주문 상품 정보 관리
- **주요 컬럼**: ORDER_ITEM_ID, ORDER_ID, PRODUCT_ID, QUANTITY, UNIT_PRICE

##### CATEGORIES 테이블
- **목적**: 상품 분류 관리
- **주요 컬럼**: CATEGORY_ID, CATEGORY_CODE, CATEGORY_NAME

##### BRANDS 테이블
- **목적**: 브랜드 정보 관리
- **주요 컬럼**: BRAND_ID, BRAND_CODE, BRAND_NAME

##### SUPPLIERS 테이블
- **목적**: 공급업체 정보 관리
- **주요 컬럼**: SUPPLIER_ID, SUPPLIER_NAME

##### WAREHOUSES 테이블
- **목적**: 창고 정보 관리
- **주요 컬럼**: WAREHOUSE_ID, WAREHOUSE_NAME, LOCATION

##### INVENTORIES 테이블
- **목적**: 재고 정보 관리
- **주요 컬럼**: INVENTORY_ID, PRODUCT_ID, CURRENT_STOCK

##### PRODUCT_REVIEWS 테이블
- **목적**: 상품 리뷰 관리
- **주요 컬럼**: REVIEW_ID, PRODUCT_ID, CUSTOMER_ID, RATING, REVIEW_TEXT

##### DISCOUNTS 테이블
- **목적**: 할인 정보 관리
- **주요 컬럼**: DISCOUNT_ID, PRODUCT_ID, DISCOUNT_RATE, START_DATE, END_DATE

#### 2.1.3 기타 스키마 테이블

##### PUBLIC.USER_ROLE 테이블
- **목적**: 사용자 역할 관리
- **주요 컬럼**: USER_ID, ROLE_ID

##### SCOTT.DYNAMIC_DATA 테이블
- **목적**: 동적 데이터 관리
- **주요 컬럼**: ID, NAME, STATUS

##### SCOTT.RELATED_DATA 테이블
- **목적**: 관련 데이터 관리
- **주요 컬럼**: ID, RELATED_ID, VALUE

### 2.2 테이블 관계
- `USERS.USER_TYPE` → `USER_TYPES.TYPE_CODE` (FK)
- `PRODUCTS.CATEGORY_ID` → `CATEGORIES.CATEGORY_ID` (FK)
- `PRODUCTS.BRAND_ID` → `BRANDS.BRAND_ID` (FK)
- `PRODUCTS.SUPPLIER_ID` → `SUPPLIERS.SUPPLIER_ID` (FK)
- `PRODUCTS.WAREHOUSE_ID` → `WAREHOUSES.WAREHOUSE_ID` (FK)
- `ORDERS.CUSTOMER_ID` → `CUSTOMERS.CUSTOMER_ID` (FK)
- `ORDER_ITEMS.ORDER_ID` → `ORDERS.ORDER_ID` (FK)
- `ORDER_ITEMS.PRODUCT_ID` → `PRODUCTS.PRODUCT_ID` (FK)

## 3. Java 클래스 분석

### 3.1 Controller 패키지

#### 3.1.1 UserController
- **파일**: `src/main/java/com/example/controller/UserController.java`
- **기능**: 사용자 관련 웹 요청 처리
- **주요 메서드**:
  - `getUserList()`: 사용자 목록 조회 (GET /user/list)
    - 파라미터: name, email, status (선택적)
    - 반환: user/list.jsp
  - `searchUsers()`: 고급 사용자 검색 (POST /user/search)
    - 파라미터: userType, minAge, maxAge, startDate, endDate
    - 반환: user/searchResult.jsp
  - `getUsersByType()`: 타입별 사용자 조회 (GET /user/dynamic/{type})
    - 파라미터: type (경로 변수)
    - 반환: user/typeList.jsp

#### 3.1.2 ProductController
- **파일**: `src/main/java/com/example/controller/ProductController.java`
- **기능**: 상품 관련 웹 요청 처리
- **주요 메서드**:
  - `getProductList()`: 상품 목록 조회 (GET /product/list)
    - 파라미터: name, category, status (선택적)
    - 반환: product/list.jsp
  - `searchProducts()`: 고급 상품 검색 (POST /product/search)
    - 파라미터: categoryId, minPrice, maxPrice, minStock, maxStock
    - 반환: product/searchResult.jsp
  - `getProductsByCategory()`: 카테고리별 상품 조회 (GET /product/category/{categoryId})
    - 파라미터: categoryId (경로 변수)
    - 반환: product/categoryList.jsp
  - `updateProductStock()`: 상품 재고 업데이트 (POST /product/updateStock)
    - 파라미터: productId, quantity
    - 반환: product/updateResult.jsp

#### 3.1.3 ErrorController
- **파일**: `src/main/java/com/example/controller/ErrorController.java`
- **기능**: 의도적인 오류 코드 포함 (테스트용)
- **오류 유형**:
  - 컴파일 오류: 타입 불일치, 중복 변수 선언
  - 런타임 오류: NullPointerException, ArrayIndexOutOfBoundsException
  - 논리 오류: 무한 루프, break 누락
  - SQL Injection: 보안 취약점 예시

#### 3.1.4 SyntaxErrorController
- **파일**: `src/main/java/com/example/controller/SyntaxErrorController.java`
- **기능**: 문법 오류가 수정된 정상적인 컨트롤러
- **주요 메서드**:
  - `test1()`, `test2()`: 기본 테스트 메서드
  - `getAllUsers()`: 전체 사용자 조회
  - `getUserById()`: ID로 사용자 조회
  - `createUser()`: 사용자 생성

### 3.2 Service 패키지

#### 3.2.1 UserService
- **파일**: `src/main/java/com/example/service/UserService.java`
- **기능**: 사용자 관련 비즈니스 로직 인터페이스
- **주요 메서드**:
  - `getUsersByCondition()`: 조건부 사용자 조회
  - `getUsersByAdvancedCondition()`: 고급 조건부 사용자 조회
  - `getUsersByType()`: 타입별 사용자 조회
  - `getUserById()`: ID로 사용자 조회
  - `updateUserDynamic()`: 동적 사용자 업데이트
  - `deleteUsersByCondition()`: 조건부 사용자 삭제

#### 3.2.2 ProductService
- **파일**: `src/main/java/com/example/service/ProductService.java`
- **기능**: 상품 관련 비즈니스 로직 인터페이스
- **주요 메서드**:
  - `getProductsByCondition()`: 조건부 상품 조회
  - `getProductsByAdvancedCondition()`: 고급 조건부 상품 조회
  - `getProductsByCategory()`: 카테고리별 상품 조회
  - `getProductById()`: ID로 상품 조회
  - `updateProductStock()`: 상품 재고 업데이트
  - `updateProductDynamic()`: 동적 상품 업데이트
  - `deleteProductsByCondition()`: 조건부 상품 삭제

### 3.3 Mapper 패키지

#### 3.3.1 UserMapper
- **파일**: `src/main/java/com/example/mapper/UserMapper.java`
- **기능**: 사용자 데이터 접근 인터페이스
- **주요 메서드**:
  - `selectUsersByCondition()`: 조건부 사용자 조회
  - `selectUsersByAdvancedCondition()`: 고급 조건부 사용자 조회
  - `selectUsersByType()`: 타입별 사용자 조회
  - `selectUserById()`: ID로 사용자 조회
  - `updateUserDynamic()`: 동적 사용자 업데이트
  - `insertUserDynamic()`: 동적 사용자 삽입
  - `deleteUsersByCondition()`: 조건부 사용자 삭제
  - `countUsersByCondition()`: 조건부 사용자 카운트

#### 3.3.2 ProductMapper
- **파일**: `src/main/java/com/example/mapper/ProductMapper.java`
- **기능**: 상품 데이터 접근 인터페이스
- **주요 메서드**:
  - `selectProductsByCondition()`: 조건부 상품 조회
  - `selectProductsByAdvancedCondition()`: 고급 조건부 상품 조회
  - `selectProductsByCategory()`: 카테고리별 상품 조회
  - `selectProductById()`: ID로 상품 조회
  - `updateProductStock()`: 상품 재고 업데이트
  - `updateProductDynamic()`: 동적 상품 업데이트
  - `insertProductDynamic()`: 동적 상품 삽입
  - `deleteProductsByCondition()`: 조건부 상품 삭제
  - `countProductsByCondition()`: 조건부 상품 카운트

### 3.4 Model 패키지

#### 3.4.1 User
- **파일**: `src/main/java/com/example/model/User.java`
- **기능**: 사용자 도메인 객체
- **주요 속성**:
  - `id`: 사용자 고유 식별자 (Long)
  - `username`: 사용자명 (String)
  - `email`: 이메일 주소 (String)
  - `password`: 암호화된 비밀번호 (String)
  - `name`: 사용자 실명 (String)
  - `age`: 나이 (Integer)
  - `status`: 계정 상태 (String)
  - `userType`: 사용자 유형 (String)
  - `phone`: 전화번호 (String)
  - `address`: 주소 (String)
  - `createdDate`: 계정 생성일 (Date)
  - `updatedDate`: 정보 수정일 (Date)

#### 3.4.2 Product
- **파일**: `src/main/java/com/example/model/Product.java`
- **기능**: 상품 도메인 객체
- **주요 속성**:
  - `productId`: 상품 고유 식별자 (String)
  - `productName`: 상품명 (String)
  - `description`: 상품 설명 (String)
  - `price`: 가격 (Double)
  - `stockQuantity`: 재고 수량 (Integer)
  - `status`: 상태 (String)
  - `categoryId`: 분류 ID (String)
  - `brandId`: 브랜드 ID (String)
  - `supplierId`: 공급업체 ID (String)
  - `warehouseId`: 창고 ID (String)
  - `createdDate`: 생성일 (Date)
  - `updatedDate`: 수정일 (Date)
  - `delYn`: 삭제 여부 (String)

## 4. 주요 기능 분석

### 4.1 동적 쿼리 처리
- **MyBatis 동적 쿼리**: `<if>`, `<where>`, `<set>`, `<foreach>` 태그 활용
- **조건부 검색**: 사용자 입력에 따른 동적 WHERE 절 생성
- **복잡한 JOIN**: 여러 테이블 간의 관계 조회
- **동적 INSERT/UPDATE**: 필요한 컬럼만 동적으로 처리

### 4.2 검색 기능
- **기본 검색**: 이름, 이메일, 상태별 검색
- **고급 검색**: 나이 범위, 날짜 범위, 복합 조건 검색
- **카테고리별 검색**: 상품 카테고리별 필터링
- **타입별 검색**: 사용자 유형별 필터링

### 4.3 CRUD 작업
- **Create**: 동적 사용자/상품 생성
- **Read**: 다양한 조건의 조회 기능
- **Update**: 동적 업데이트, 재고 관리
- **Delete**: 조건부 삭제, 논리 삭제

## 5. 오류 처리 및 테스트

### 5.1 의도적 오류 코드
- **컴파일 오류**: 타입 불일치, 중복 변수 선언
- **런타임 오류**: NullPointerException, ArrayIndexOutOfBoundsException
- **논리 오류**: 무한 루프, break 누락
- **SQL Injection**: 보안 취약점 예시

### 5.2 정상 코드 예시
- **SyntaxErrorController**: 문법 오류가 수정된 정상적인 컨트롤러
- **적절한 예외 처리**: try-catch 블록 활용
- **올바른 어노테이션 사용**: Spring 어노테이션 정확한 적용

## 6. 보안 및 성능 고려사항

### 6.1 보안 이슈
- **SQL Injection**: 문자열 연결을 통한 쿼리 생성 위험
- **XSS**: JSP에서 사용자 입력 직접 출력
- **CSRF**: 토큰 검증 부재

### 6.2 성능 최적화
- **동적 쿼리**: 필요한 조건만 포함하여 성능 향상
- **인덱스 활용**: PK, FK 기반 조회 최적화
- **페이징**: 대용량 데이터 처리 고려 필요

## 7. 개선 제안

### 7.1 코드 품질
- **예외 처리**: 전역 예외 처리기 구현
- **로깅**: 적절한 로깅 레벨 적용
- **검증**: 입력 데이터 유효성 검증 강화

### 7.2 보안 강화
- **SQL Injection 방지**: PreparedStatement 사용
- **XSS 방지**: 출력 데이터 이스케이프 처리
- **CSRF 보호**: 토큰 기반 인증 구현

### 7.3 성능 개선
- **캐싱**: 자주 조회되는 데이터 캐싱
- **페이징**: 대용량 데이터 페이징 처리
- **인덱스**: 조회 성능 향상을 위한 인덱스 최적화

---

**Part 2에서는 JSP 페이지 명세, MyBatis XML 매퍼 분석, 상세 검증 프로세스를 다룹니다.**
