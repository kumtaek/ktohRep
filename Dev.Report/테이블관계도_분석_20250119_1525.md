# 테이블 관계도 분석 (sampleSrc 프로젝트)

## 1. 테이블 목록 (15개)

### PUBLIC 스키마
- **USER_ROLE** (PK: ROLE_ID, USER_ID - 복합키)

### SAMPLE 스키마  
- **BRANDS** (PK: BRAND_ID)
- **CATEGORIES** (PK: CATEGORY_ID)
- **CUSTOMERS** (PK: CUSTOMER_ID)
- **DISCOUNTS** (PK: DISCOUNT_ID)
- **INVENTORIES** (PK: INVENTORY_ID)
- **ORDERS** (PK: ORDER_ID)
- **ORDER_ITEMS** (PK: ORDER_ITEM_ID)
- **PRODUCTS** (PK: PRODUCT_ID)
- **PRODUCT_REVIEWS** (PK: REVIEW_ID)
- **SUPPLIERS** (PK: SUPPLIER_ID)
- **USERS** (PK: USER_ID)
- **WAREHOUSES** (PK: WAREHOUSE_ID)

### SCOTT 스키마
- **DYNAMIC_DATA** (PK: ID)
- **RELATED_DATA** (PK: ID)

## 2. 테이블 간 관계 (→ 화살표 표시)

### 2.1 핵심 비즈니스 관계

```
고객 관련:
CUSTOMERS → ORDERS (CUSTOMER_ID)
CUSTOMERS → PRODUCT_REVIEWS (CUSTOMER_ID)
USERS → USER_ROLE (USER_ID)

주문 관련:
ORDERS → ORDER_ITEMS (ORDER_ID)
ORDER_ITEMS → PRODUCTS (PRODUCT_ID)

상품 관련:
PRODUCTS → BRANDS (BRAND_ID)
PRODUCTS → CATEGORIES (CATEGORY_ID)  
PRODUCTS → SUPPLIERS (SUPPLIER_ID)
PRODUCTS → WAREHOUSES (WAREHOUSE_ID)

재고 및 할인:
INVENTORIES → PRODUCTS (PRODUCT_ID)
DISCOUNTS → PRODUCTS (PRODUCT_ID)
PRODUCT_REVIEWS → PRODUCTS (PRODUCT_ID)
```

### 2.2 상세 관계 화살표

```
┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   USERS     │───→│ USER_ROLE   │←───│             │
│ (USER_ID)   │    │(USER_ID,    │    │             │
└─────────────┘    │ ROLE_ID)    │    │             │
                   └─────────────┘    │             │
                                      │             │
┌─────────────┐    ┌─────────────┐    │             │
│ CUSTOMERS   │───→│   ORDERS    │    │             │
│(CUSTOMER_ID)│    │(ORDER_ID)   │    │             │
└─────────────┘    └─────────────┘    │             │
       │                  │           │             │
       │           ┌─────────────┐    │             │
       └──────────→│ORDER_ITEMS  │    │             │
                   │(ORDER_ITEM_ │    │             │
                   │    ID)      │    │             │
                   └─────────────┘    │             │
                          │           │             │
                          ▼           │             │
                   ┌─────────────┐    │             │
                   │  PRODUCTS   │◄───┘             │
                   │(PRODUCT_ID) │                  │
                   └─────────────┘                  │
                     │ │ │ │                       │
        ┌────────────┘ │ │ └──────────────┐        │
        │              │ │                │        │
        ▼              ▼ ▼                ▼        │
┌─────────────┐ ┌─────────────┐ ┌─────────────┐    │
│   BRANDS    │ │ CATEGORIES  │ │ SUPPLIERS   │    │
│ (BRAND_ID)  │ │(CATEGORY_ID)│ │(SUPPLIER_ID)│    │
└─────────────┘ └─────────────┘ └─────────────┘    │
                                                   │
        ┌──────────────────────────────────────────┘
        │              │
        ▼              ▼
┌─────────────┐ ┌─────────────┐
│ WAREHOUSES  │ │INVENTORIES  │
│(WAREHOUSE_  │ │(INVENTORY_  │
│    ID)      │ │    ID)      │
└─────────────┘ └─────────────┘
                       │
                       ▼
                ┌─────────────┐
                │  PRODUCTS   │
                │(PRODUCT_ID) │
                └─────────────┘
                       │
                       ▼
                ┌─────────────┐
                │ DISCOUNTS   │
                │(DISCOUNT_ID)│
                └─────────────┘
```

### 2.3 추정 Foreign Key 관계

```
ORDERS.CUSTOMER_ID          → CUSTOMERS.CUSTOMER_ID
ORDER_ITEMS.ORDER_ID        → ORDERS.ORDER_ID
ORDER_ITEMS.PRODUCT_ID      → PRODUCTS.PRODUCT_ID
PRODUCTS.BRAND_ID           → BRANDS.BRAND_ID
PRODUCTS.CATEGORY_ID        → CATEGORIES.CATEGORY_ID
PRODUCTS.SUPPLIER_ID        → SUPPLIERS.SUPPLIER_ID
PRODUCTS.WAREHOUSE_ID       → WAREHOUSES.WAREHOUSE_ID
INVENTORIES.PRODUCT_ID      → PRODUCTS.PRODUCT_ID
DISCOUNTS.PRODUCT_ID        → PRODUCTS.PRODUCT_ID
PRODUCT_REVIEWS.CUSTOMER_ID → CUSTOMERS.CUSTOMER_ID
PRODUCT_REVIEWS.PRODUCT_ID  → PRODUCTS.PRODUCT_ID
USER_ROLE.USER_ID           → USERS.USER_ID
```

## 3. 관계 통계

### 3.1 참조되는 테이블 (부모 테이블)
- **PRODUCTS**: 5개 테이블에서 참조 (가장 중심적)
- **CUSTOMERS**: 2개 테이블에서 참조
- **ORDERS**: 1개 테이블에서 참조
- **USERS**: 1개 테이블에서 참조

### 3.2 참조하는 테이블 (자식 테이블)
- **PRODUCTS**: 4개 테이블 참조 (BRANDS, CATEGORIES, SUPPLIERS, WAREHOUSES)
- **ORDER_ITEMS**: 2개 테이블 참조 (ORDERS, PRODUCTS)
- **USER_ROLE**: 1개 테이블 참조 (USERS)

### 3.3 독립 테이블
- **DYNAMIC_DATA** (SCOTT 스키마)
- **RELATED_DATA** (SCOTT 스키마)

## 4. ERD 핵심 구조

```
           CUSTOMERS
               ↓
           ORDERS ← ORDER_ITEMS
               ↓         ↓
           PRODUCTS ← (할인, 재고, 리뷰)
          ↙ ↓ ↓ ↘
    BRANDS CATEGORIES SUPPLIERS WAREHOUSES
```

## 5. 다음 단계 작업

1. **FK 제약조건 생성**: 추정된 관계를 edges 테이블에 등록
2. **SQL 조인 분석**: MyBatis XML에서 실제 사용되는 조인 관계 확인
3. **ERD 시각화**: 관계선이 포함된 ERD 생성
4. **데이터 무결성 검증**: FK 관계의 실제 데이터 일치성 확인
